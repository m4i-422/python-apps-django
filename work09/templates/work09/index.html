{% load static %}
<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>work09 TODOアプリ</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>

<body>
    <header class="app-header">
        <h1>work09 TODOアプリ</h1>
    </header>

    <main class="container">
        <div class="actions">
            <a href="{% url 'work09:create' %}" class="btn">新規作成</a>
            <a href="?filter=incomplete" class="btn">未完了のみ表示</a>
            <a href="?sort=created" class="btn">登録日でソート</a>
            <a href="?sort=due" class="btn">期限日でソート</a>
        </div>

        <table>
            <tr>
                <th>完了</th>
                <th>タスク名</th>
                <th>期限日</th>
                <th>登録日</th>
                <th>操作</th>
            </tr>
            {% for todo in todos %}
            <tr class="{% if todo.is_completed %}completed{% elif todo.due_date < today %}overdue{% endif %}">
                <td>
                    <form action="{% url 'work09:toggle' todo.id %}" method="post" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit">
                            {% if todo.is_completed %}完了済みに戻す{% else %}完了{% endif %}
                        </button>
                    </form>
                </td>
                <td><a href="{% url 'work09:edit' todo.id %}">{{ todo.title }}</a></td>
                <td>{{ todo.due_date }}</td>
                <td>{{ todo.created_at }}</td>
                <td>
                    <a href="{% url 'work09:delete' todo.id %}">削除</a>
                </td>
            </tr>

            {% empty %}
            <tr>
                <td colspan="5">タスクがありません</td>
            </tr>
            {% endfor %}
        </table>
    </main>
</body>

</html>